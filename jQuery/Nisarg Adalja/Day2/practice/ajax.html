<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ajax</title>
    <link rel="stylesheet" href="../../assests/css/bootstrap.min.css">
    <script src="../../assests/js/jquery-3.6.0.js"></script>
    <script src="../../assests/js/bootstrap.bundle.js"></script>

</head>

<body>
    <div id="demo">
        <h1>The XMLHttpRequest Object</h1>
        <button type="button" onclick="loadDoc()">Change Content</button>

        <button type="button" onclick="loadDoc('ajax_info.txt', myFunction)">Change Content</button>
        <button type="button" onclick="loadDoc2()">Get my CD collection</button>
<br><br>
    </div>
    <div id="demo2"></div>
    <div id="demo1"></div>

  
    <script>
        /*jQuery - AJAX Introduction
        AJAX is the art of exchanging data with a server, and updating parts of a web page -
            without reloading the whole page.

        jQuery AJAX Example
        Let jQuery AJAX Change This Text
        Get External Content
        What is AJAX ?
            AJAX = Asynchronous JavaScript and XML.

        In short;
        AJAX is about loading data in the background and display it on the webpage, without reloading the whole page.

        Examples of applications using AJAX: Gmail, Google Maps, Youtube, and Facebook tabs.

        You can learn more about AJAX in our AJAX tutorial.
        What About jQuery and AJAX ?
            jQuery provides several methods
        for AJAX functionality.

        With the jQuery AJAX methods, you can request text, HTML, XML,
        or JSON from a remote server using both HTTP Get and HTTP Post -
            And you can load the external data directly into the selected HTML elements of your web page!

            Without jQuery, AJAX coding can be a bit tricky!

            Writing regular AJAX code can be a bit tricky, because different browsers have different syntax
        for AJAX implementation.This means that you will have to write extra code to test
        for different browsers.However, the jQuery team has taken care of this
        for us, so that we can write AJAX functionality with only one single line of code.

        jQuery AJAX Methods
        In the next chapters we will look at the most important jQuery AJAX methods. */

        /*AJAX is a developer's dream, because you can:

        Update a web page without reloading the page
        Request data from a server - after the page has loaded
        Receive data from a server - after the page has loaded
        Send data to a server - in the background */
        function loadDoc() {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    document.getElementById("demo2").innerHTML =
                        this.responseText;
                }
            };
            xhttp.open("GET", "ajax_info.txt", true);
            xhttp.send();
        }
        /*The XMLHttpRequest Object
        All modern browsers support the XMLHttpRequest object.

        The XMLHttpRequest object can be used to exchange data with a server behind the scenes
            .This means that it is possible to update parts of a web page, without reloading the whole page.

        Create an XMLHttpRequest Object
        All modern browsers(Chrome, Firefox, Edge(and IE7 + ), Safari, Opera) have a built - in XMLHttpRequest object.

        Syntax
        for creating an XMLHttpRequest object:

        variable = new XMLHttpRequest();
        
        var xhttp = new XMLHttpRequest();*/

        /*The XMLHttpRequest Object
        All modern browsers support the XMLHttpRequest object.

        The XMLHttpRequest object can be used to exchange data with a server behind the scenes
            .This means that it is possible to update parts of a web page, without reloading the whole page.

        Create an XMLHttpRequest Object
        All modern browsers(Chrome, Firefox, Edge(and IE7 + ), Safari, Opera) have a built - in XMLHttpRequest object.

        Syntax
        for creating an XMLHttpRequest object: */

        /* XMLHttpRequest Object Methods

        Method                                  Description
        new XMLHttpRequest()                    Creates a new XMLHttpRequest object
        abort()                                 Cancels the current request
        getAllResponseHeaders()                 Returns header information
        getResponseHeader()                     Returns specific header information
        open(method, url, async, user, psw)     Specifies the request
                                                method: the request type GET or POST
                                                url: the file location
                                                async :true(asynchronous) or false(synchronous)
                                                user: optional user name
                                                psw: optional password
        send()                                  Sends the request to the server Used for GET requests
        send(string)                            Sends the request to the server. Used for POST requests
        setRequestHeader()                      Adds a label / value pair to the header to be sent


        XMLHttpRequest Object Properties


        Property                                Description
        
        onreadystatechange                      Defines a function to be called when the readyState property changes
        
        readyState                              Holds the status of the XMLHttpRequest.
                                                0: request not initialized
                                                1: server connection established
                                                2: request received
                                                3: processing request
                                                4: request finished and response is ready

        responseText                            Returns the response data as a string
        
        responseXML                             Returns the response data as XML data
        
        status                                  Returns the status - number of a request
                                                200: "OK"
                                                403: "Forbidden"
                                                404: "Not Found"
                                                
        statusText                              Returns the status - text(e.g "OK" or "Not Found") */
        /*AJAX - Send a Request To a Server
        The XMLHttpRequest object is used to exchange data with a server.

        Send a Request To a Server
        To send a request to a server, we use the open() and send() methods of the XMLHttpRequest object:

        xhttp.open("GET", "ajax_info.txt", true);
        xhttp.send(); */

        /*GET or POST ?
            GET is simpler and faster than POST, and can be used in most cases.

        However, always use POST requests when:

            A cached file is not an option(update a file or database on the server).
        Sending a large amount of data to the server(POST has no size limitations).
        Sending user input(which can contain unknown characters), POST is more robust and secure than GET.*/
        function loadDoc1() {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    document.getElementById("demo").innerHTML =
                        this.responseText;
                }
            };
            xhttp.open("GET", "ajex_info.txt?fname=Nisarg&lname=Adalja", true);
            xhttp.send();
        }
        /*Asynchronous - True or False ?
            Server requests should be sent asynchronously.

        The async parameter of the open() method should be set to true:

            xhttp.open("GET", "ajax_test.asp", true);
        By sending asynchronously, the JavaScript does not have to wait
        for the server response, but can instead:

            execute other scripts
        while waiting
        for server response
        deal with the response after the response is ready
        
        The onreadystatechange Property
        With the XMLHttpRequest object you can define a function to be executed when the request receives an answer.

        The function is defined in the onreadystatechange property of the XMLHttpResponse object:
        */

        function loadDoc(url, cFunction) {
            var xhttp;
            xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    cFunction(this);
                }
            };
            xhttp.open("GET", url, true);
            xhttp.send();
        }

        function myFunction(xhttp) {
            document.getElementById("demo").innerHTML =
                xhttp.responseText;
        }


        function loadDoc2() {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    myFunction(this);
                }
            };
            xhttp.open("GET", "filtering.html", true);
            xhttp.send();
        }

        function myFunction(xml) {
            var i;
            alert(xml);
            var xmlDoc = xml.responseText;
            alert(xmlDoc);
            //var table = "<tr><th>Title</th><th>Artist</th></tr>";
            var x = xmlDoc;
            alert(x);
            
            document.getElementById("demo1").innerHTML = x;
        }
    </script>
    
</body>

</html>